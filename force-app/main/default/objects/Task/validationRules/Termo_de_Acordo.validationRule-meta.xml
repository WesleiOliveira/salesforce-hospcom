<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Termo_de_Acordo</fullName>
    <active>true</active>
    <errorConditionFormula>AND(
    $User.Id != &apos;0055A00000BcBOn&apos;,
    OR(
        ISNEW(),
        ISCHANGED(ActivityDate),
        ISCHANGED(OwnerId)
    ),
    AND(
        Subject = &apos;Termo de Acordo&apos;,
        ActivityDate &lt;= CASE(
            MOD(WEEKDAY(TODAY()), 7),
            2, TODAY() + 2,  /* Segunda → +2 úteis = quarta */
            3, TODAY() + 2,  /* Terça → +2 úteis = quinta */
            4, TODAY() + 2,  /* Quarta → +2 úteis = sexta */
            5, TODAY() + 4,  /* Quinta → +2 úteis (pula fim de semana) = segunda */
            6, TODAY() + 4,  /* Sexta → +2 úteis (pula fim de semana) = terça */
            7, TODAY() + 3,  /* Sábado → +2 úteis (pula fim de semana) = terça */
            1, TODAY() + 2,  /* Domingo → +2 úteis = terça */
            TODAY() + 2 /* Padrão: pelo menos 2 dias úteis */
        )
    )
)</errorConditionFormula>
    <errorDisplayField>ActivityDate</errorDisplayField>
    <errorMessage>O prazo mínimo para Termo de Acordo é de dois dias úteis.</errorMessage>
</ValidationRule>
