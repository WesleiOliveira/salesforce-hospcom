/* Generated by TestGen on Mon Dec 13 2021 at 6:49 PM (GMT) */
@isTest(seeAllData=true)
private class ApexHelperControllerTest{
    @isTest
    private static void executeSoql(){
        Test.startTest();
        ApexHelperController.executeSoql('SELECT Id, Name FROM Account LIMIT 10');
        ApexHelperController.saveDoc('teste', 'name', 'txt', 'text/plain', 'LOG INTEGRACAO SAP 2.0');
        ApexHelperController.changeStatusPurchaseOrder('a1b6e000003ys7AAAQ');
        ApexHelperController.changeStatusSalesOrder('8015A000001UiYoQAK');
        ApexHelperController.updateOrderAdress('8016e000008T9VVAA0', 'Cobranca','PRIMEIRA AVENIDA, 545, LESTE UNIVERSITARIO','GOIANIA','Goiás','74.605-020');
        ApexHelperController.updateOrderAdress('8016e000008T9VVAA0', 'Entrega','PRIMEIRA AVENIDA, 545, LESTE UNIVERSITARIO','GOIANIA','Goiás','74.605-020');
        ApexHelperController.listagem('WorkOrder', 'T_cnico_Respons_vel__c');
        ApexHelperController.obterTiposDeRegistros('WorkOrder');
        Test.stopTest();
    }
    @isTest
    static void testUploadPDF() {
        // Preparação dos dados de teste
        String fileName = 'TestFile';
        String pagina = 'MinhaPagina';
        String idPC = '12345';
        
        // Mock da lógica de obtenção de PDF
        Test.setMock(HttpCalloutMock.class, new MockHttpResponseGenerator());
        
        // Chamada ao método de uploadPDF
        String link = ApexHelperController.uploadPDF(fileName, pagina, idPC);
        
        // Verificações de assert
        System.assertNotEquals(null, link, 'Link não deveria ser nulo');
        System.assert(link.startsWith('http') || link.startsWith('https'), 'Link deveria começar com "http" ou "https"');
    }
    
    // Mock para simular a chamada HTTP e resposta
    public class MockHttpResponseGenerator implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest req) {
            // Simular retorno de PDF como conteúdo
            Blob pdfBlob = Blob.valueOf('PDF Content');
            String base64PDF = EncodingUtil.base64Encode(pdfBlob);
            
            HTTPResponse res = new HTTPResponse();
            res.setStatusCode(200);
            res.setBody('{"rendered":"http://example.com/pdf-link","r');
            return res;
        }
    }
    @isTest
    static void testSendToChatGPT() {
        
        // Configuração do Mock HTTP
        Test.setMock(HttpCalloutMock.class, new ChatGPTHttpMock());
                
        // Chamar o método sendToChatGPT com o ID do vendedor
        Test.startTest();
        String response = ApexHelperController.sendToChatGPT('0056e00000CU7Kl');
        Test.stopTest();
    }
    // Classe de Mock para simular a resposta da API do ChatGPT
    public class ChatGPTHttpMock implements HttpCalloutMock {
        
        public HTTPResponse respond(HTTPRequest req) {
            // Simulando uma resposta HTTP bem-sucedida da API do ChatGPT
            HTTPResponse response = new HTTPResponse();
            response.setStatusCode(200);
            String mockResponseBody = '{"choices":[{"message":{"role":"system","content":"Analisando dados financeiros. O vendedor João tem um forecast de 10000. Meta para o mês é 15000, falta 5000 para atingir a meta. A oportunidade está em aberto, e o vendedor é João."}}]}';
            response.setBody(mockResponseBody);
            response.setHeader('Content-Type', 'application/json');
            return response;
        }
    }
    @isTest
    static void testUpdateRecords() {
        // Cria dois registros de Item com os IDs fornecidos (mocked)
        Item_da_Solicita_o_de_devolu_o__c item1 = new Item_da_Solicita_o_de_devolu_o__c(
            Id = 'a0cU4000009aTCn',
            Quantidade__c = 2
        );

        Item_da_Solicita_o_de_devolu_o__c item2 = new Item_da_Solicita_o_de_devolu_o__c(
            Id = 'a0cU4000009aTCo',
            Quantidade__c = 2
        );

        // Adiciona em uma lista
        List<Item_da_Solicita_o_de_devolu_o__c> itemsToUpdate = new List<Item_da_Solicita_o_de_devolu_o__c>{ item1, item2 };

        // Serializa para JSON
        String recordsJson = JSON.serialize(itemsToUpdate);

        Test.startTest();
        ApexHelperController.updateRecords(recordsJson);
        Test.stopTest();

        // Aqui você poderia fazer asserts se estivesse inserindo registros reais.
        // Como estamos simulando com Ids fixos, a verificação real dependeria do mock/stub.
    }
    @isTest
    static void testSaveConcorrentesApex() {

        // Cria um objeto do tipo wrapper ConcorrenteData
        ApexHelperController.ConcorrenteData conc = new ApexHelperController.ConcorrenteData();
        conc.accountId = '0016e00003FBzFG';
        conc.marca = 'Marca Teste';
        conc.motivo = 'PREÇO';
        conc.situacao = 'GANHANDO';
        conc.modelo = 'TESTE';
        conc.precoUnitario = '1100';
        conc.precoTotal = '1515';
        conc.obs = 'obs de teste';
            
        // Cria uma lista e adiciona o concorrente
        String jsonConcorrente = JSON.serialize(new List<ApexHelperController.ConcorrenteData>{ conc });

        // Chama o método que queremos testar
        Test.startTest();
        ApexHelperController.saveConcorrentesApex(jsonConcorrente, '006U400000E57C9IAJ', '00kU400000E3mT3IAJ');
        Test.stopTest();

        // Valida se o registro foi inserido corretamente, supondo que você está criando um objeto custom
        List<Analise_de_Mercado__c> inserted = [
            SELECT Id, Concorrente__c FROM Analise_de_Mercado__c WHERE Concorrente__c = '0016e00003FBzFG'
        ];
        System.assertEquals(1, inserted.size());
    }
}