<apex:page renderAs="pdf" standardController="Quote" extensions="CotacaoDetalhes" standardStylesheets="false" cache="false" showHeader="false" sidebar="false" applyHtmlTag="true" applyBodyTag="false">
    <head>
        <style type="text/css" media="print">
            
            /* pdf */
            @page{
                size:A4;
                background: url({!documento.timbrado});
                margin:150px 50px 120px 50px;
                @bottom-center{content:element(paginacao);}
            }
            .pagina:before{content:counter(page);}
            .paginas:before{content:counter(pages);}
            
            /* paginação */
            .paginacao{
                height:120px;
                position:running(paginacao);
            }.paginacao .valor{
                position: absolute; 
                top: 74px;
                left: 410px;
                text-align:center;
                background-color:white;
                font-family:arial, verdana, sans-serif;
                font-size:12px;
                font-weight:600;
                color:#697f9b;
            }
            
            /* documento */
            .documento{
                padding:0px;
                margin:0px;
                font-family:arial, verdana, sans-serif;
            }.bloco{
                page-break-inside:avoid;
            }.linha{
                white-space: nowrap;
            }
            
            /* conteudo */
            .conteudo .supertitulo{
                width:100%;
                text-align:center;
                text-transform:uppercase;
                font-weight:bold;
                font-size:20px;
                white-space:pre;
                margin-bottom:10px;
            }.conteudo .titulo{
                font-size:14px;
                font-weight:bold;
                line-height:120%;
            }.conteudo .paragrafo{
                font-size:13px;
                text-align:justify;
                line-height:120%;
                text-justify:inter-word;
                text-indent:50px;
            }
            
            .conteudo .manuscrito{
                height:25px;
                border-color:#cacecf!important;
            }.conteudo .destaque{
                border-color:#cacecf;
                border-style:solid;
                border-width:2px 0px 0px 0px;
                padding-bottom:10px;
            }.conteudo .sessao{
                width:100%;
                border-collapse:collapse;
            }.conteudo .sessao .rotulo, 
             .conteudo .sessao .valor, 
             .conteudo .rotulo_doc, 
             .conteudo .valor_doc{
                font-size:11px;
                vertical-align:top;
                border-color:#eef2f4;
                border-style:solid;
                border-width:1px 0px 1px 0px;
                padding:2px;
            }.conteudo .sessao .rotulo{
                width:20%;
                font-weight:bold;
                white-space: nowrap;
                text-align:right;
                padding-right:6px;
            }.conteudo .sessao .valor{
                width:30%;
            }.conteudo .sessao .rotulo_doc{
                width:33.33%;
                font-weight:bold;
                white-space: nowrap;
                text-align:center;
            }.conteudo .sessao .valor_doc{
                width:100%;
                white-space: nowrap;
            }
            
            .conteudo .obsimgs{
                text-align:right;
                font-size:11px;
                font-weight:bold;
                font-style:italic;
            }.conteudo .assinatura{
                width:100%;
            }.conteudo .assinatura td{
                width:50%;
                font-size:13px;
                line-height:130%;
            }
            
            /* listagem */
            .listagem{ 
                width:100%;
            }.listagem table{ 
                width:100%;
                border-collapse:collapse;
            }.listagem td{ 
                padding:2px 5px;
                line-height:120%;
            }.listagem .pre-cabecalho{
                height:10px;
            }.listagem .cabecalho td{
                font-size:12px;
                font-weight:bold;
                background-color:#e2e3e3;
                white-space: nowrap;
                border-color:#cacecf;
                border-style:solid;
                border-width:1px 0px 1px 0px;
            }.listagem .item-dados .imagem{
                vertical-align:middle;
            }.listagem .item-dados.acessorio .imagem{
                text-align:right;
            }.listagem .item-dados.equipamento img{
                width: 80px;
                height: 80px; 
            }.listagem .item-dados.acessorio img{
                width: 55px;
                height: 55px; 
            }.listagem .item-dados .valor{
                border-color:#eef2f4;
                border-style:solid;
                border-width:1px 0px 0px 0px;
            }.listagem .item-dados td{
                font-size:10px;
                vertical-align:top;
            }.listagem .item-descr td{
                font-size:10px;
                text-align:justify;
                vertical-align:top;
                text-justify:inter-word;
                border-color:#eef2f4;
                border-style:solid;
                border-width:0px 0px 1px 0px;
            }.listagem .subtotal{
                font-weight: bold;
                font-size:10px;
                white-space: nowrap;
            }.listagem .subtotal .valor{
                border-color:#eef2f4;
                border-style:solid;
                border-width:0px 0px 1px 0px;
            }
        </style>
    </head>
    
    <body class="documento">
        
        <!-- paginacao -->
        <div class="paginacao">
            <div class="valor">Página <span class="pagina"/> de <span class="paginas"/></div>
        </div>
        
        <!-- conteudo -->
        <div class="conteudo">
            
            <div class="supertitulo">{!documento.titulo}</div>
            <br/>
            
            <!-- Oportunidade -->
            <div class="bloco">
                <div class="titulo destaque">Oportunidade</div>
                <table class="sessao" cellpadding="0px" cellspacing="0px" border="0">
                    <tr>
                        <td class="rotulo">Oportunidade</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Name}"/>&nbsp;[{!LPAD(cotacao.Opportunity.Numero_OP__c,8,'0')}]</td>
                        <td class="rotulo">Conta</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Account.Raz_o_Social__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Vendedor</td> 
                        <td class="valor">{!documento.vendedor}</td>
                        <td class="rotulo">Contato</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Contact.Name}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Signatario</td> 
                        <td class="valor">{!documento.ass_nome}&nbsp;[{!documento.ass_cpf}]</td>
                        <td class="rotulo">Dpto. / Tipo reg.</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Departamento__c}"/>&nbsp;/&nbsp;<apex:outputField value="{!cotacao.Opportunity.RecordType.Name}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Descrição</td>
                        <td class="valor" colspan="3"><apex:outputField value="{!cotacao.Opportunity.Description}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Declarações</td>
                        <td class="valor" colspan="3"><apex:outputField value="{!cotacao.Opportunity.Declara_es__c}"/></td>
                    </tr>
                </table>
            </div>
            <br/>
            
            <!-- Cotação -->
            <div class="bloco">
                <div class="titulo destaque">Cotação</div>
                <table class="sessao" cellpadding="0px" cellspacing="0px" border="0">
                    <tr>
                        <td class="rotulo">Cotação</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Name}"/>&nbsp;[<apex:outputField value="{!cotacao.QuoteNumber}"/>]</td>
                        <td class="rotulo">Data de emissão</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Data_de_emissao__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo"></td>
                        <td class="valor"></td>
                        <td class="rotulo">Data de validade</td>
                        <td class="valor"><apex:outputField value="{!cotacao.ExpirationDate}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">End. cobrança</td>
                        <td class="valor" colspan="3">
                            <apex:outputText rendered="{!IF(cotacao.BillingStreet != null,true,false)}" >{!cotacao.BillingStreet}</apex:outputText>
                            <apex:outputText rendered="{!IF(cotacao.BillingCity != null,true,false)}" >, {!cotacao.BillingCity}</apex:outputText>
                            <apex:outputText rendered="{!IF(cotacao.BillingStateCode != null,true,false)}" >-{!cotacao.BillingStateCode}</apex:outputText>
                            <apex:outputText rendered="{!IF(cotacao.BillingPostalCode != null,true,false)}" >, CEP: {!cotacao.BillingPostalCode}</apex:outputText>
                            <apex:outputText rendered="{!IF(cotacao.BillingCountry != null,true,false)}" >, {!cotacao.BillingCountry}</apex:outputText>.
                        </td>
                    </tr>
                    <tr>
                        <td class="rotulo">End. entrega</td>
                        <td class="valor" colspan="3">
                            <apex:outputText rendered="{!IF(cotacao.ShippingStreet != null,true,false)}" >{!cotacao.ShippingStreet}</apex:outputText>
                            <apex:outputText rendered="{!IF(cotacao.ShippingCity != null,true,false)}" >, {!cotacao.ShippingCity}</apex:outputText>
                            <apex:outputText rendered="{!IF(cotacao.ShippingStateCode != null,true,false)}" >-{!cotacao.ShippingStateCode}</apex:outputText>
                            <apex:outputText rendered="{!IF(cotacao.ShippingPostalCode != null,true,false)}" >, CEP: {!cotacao.ShippingPostalCode}</apex:outputText>
                            <apex:outputText rendered="{!IF(cotacao.ShippingCountry != null,true,false)}" >, {!cotacao.ShippingCountry}</apex:outputText>.
                        </td>
                    </tr>
                </table>
            </div>
            <br/>
            
            <!-- Processo -->
            <div class="bloco">
                <div class="titulo destaque">Processo</div>
                <table class="sessao" cellpadding="0px" cellspacing="0px" border="0">
                    <tr>
                        <td class="rotulo">Modalidade</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Modalidade__c}"/></td>
                        <td class="rotulo">Data da abertura</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Data_da_Abertura__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Local</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Local__c}"/></td>
                        <td class="rotulo">Data de fechamento</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.CloseDate}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Num. processo</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Processo__c}"/></td>
                        <td class="rotulo"></td>
                        <td class="valor"></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Exclusivo ME/EPP</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Exclusivo_ME_EPP__c}"/></td>
                        <td class="rotulo">ATA SRP</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.ATA_SRP__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Verba</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Verba__c}"/></td>
                        <td class="rotulo">Data inicio ATA</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Data_do_Inicio_da_ATA__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Num. verba</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Numero_Verba__c}"/></td>
                        <td class="rotulo">Data fim ATA</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Data_do_Fim_da_ATA__c}"/></td>
                    </tr>
                </table>
            </div>
            <br/>
            
            <!-- Impugnação e recurso -->
            <div class="bloco">
                <div class="titulo destaque">Impugnação e recurso</div>
                <table class="sessao" cellpadding="0px" cellspacing="0px" border="0">
                    <tr>
                        <td class="rotulo">Necessário impugnar</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Necess_rio_Impugnar__c}"/></td>
                        <td class="rotulo">Necessário recurso</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Necess_rio_Recurso__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Prazo impugnação</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Prazo_Impugna_o__c}"/></td>
                        <td class="rotulo">Prazo recurso</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Prazo_Recurso__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Protocolo impugnação</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Protocolo_Impugnacao__c}"/></td>
                        <td class="rotulo">Protocolo recurso</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Protocolo_Recurso__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Motivo da impugnação</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Motivo_da_Impugna_o__c}"/></td>
                        <td class="rotulo">Motivo recurso</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Motivo_Recurso__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Itens a impugnar</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Itens_a_Impugnar__c}"/></td>
                        <td class="rotulo">Itens para recurso</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Itens_para_recurso__c}"/></td>
                    </tr>
                </table>
            </div>
            <br/>
            
            <!-- Documentações -->
            <div class="bloco">
                <div class="titulo destaque">Documentações</div>
                <table class="sessao" cellpadding="0px" cellspacing="0px" border="0">
                    <tr>
                        <td class="rotulo_doc">Credenciamento</td>
                        <td class="rotulo_doc">Habilitação</td>
                        <td class="rotulo_doc">Proposta</td>
                    </tr>
                    <tr>
                        <td style="vertical-align:top;">
                            <apex:repeat value="{!documento.docs_cred}" var="doc">
                                <div class="valor_doc" style="border-top:0px;">&nbsp;-&nbsp;{!doc}</div>
                            </apex:repeat>
                        </td>
                        <td style="vertical-align:top;">
                            <apex:repeat value="{!documento.docs_habi}" var="doc">
                                <div class="valor_doc" style="border-top:0px;">&nbsp;-&nbsp;{!doc}</div>
                            </apex:repeat>
                        </td>
                        <td style="vertical-align:top;">
                            <apex:repeat value="{!documento.docs_prop}" var="doc">
                                <div class="valor_doc" style="border-top:0px;">&nbsp;-&nbsp;{!doc}</div>
                            </apex:repeat>
                        </td>
                    </tr>
                </table>
            </div>
            <br/>
            
            <!-- Pagamento, garantia e entrega -->
            <div class="bloco">
                <div class="titulo destaque">Pagamento, garantia e entrega</div>
                <table class="sessao" cellpadding="0px" cellspacing="0px" border="0">
                    <tr>
                        <td class="rotulo">Forma de pagamento</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Forma_de_pagamento__c}"/></td>
                        <td class="rotulo">Tipo de envio</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Frete__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Condição de pagamento</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Condicao_de_pagamento__c}"/></td>
                        <td class="rotulo">Praz entrega pedido</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Prazo_de_Entrega__c}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo">Prazo de garantia</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Prazo_de_garantia__c}"/></td>
                        <td class="rotulo">Praz entrega edital</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Prazo_de_entrega_Edital__c}"/></td>
                    </tr>

                </table>
            </div>
            <br/>
            
            <!-- Faturamento e totais -->
            <div class="bloco">
                <div class="titulo destaque">Faturamento e totais</div>
                <table class="sessao" cellpadding="0px" cellspacing="0px" border="0">
                    <tr>
                        <td class="rotulo">Faturamento feito</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Opportunity.Faturamento_Feito2__r.Raz_o_Social__c}"/></td>
                        <td class="rotulo">Subtotal</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Subtotal}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo"></td>
                        <td class="valor"></td>
                        <td class="rotulo">Desconto</td>
                        <td class="valor"><apex:outputField value="{!cotacao.Discount}"/></td>
                    </tr>
                    <tr>
                        <td class="rotulo"></td>
                        <td class="valor"></td>
                        <td class="rotulo">Total</td>
                        <td class="valor"><apex:outputField value="{!cotacao.GrandTotal}"/></td>
                    </tr>
                </table>
            </div>
            <br/>
            
            <!-- Produtos -->
            <div class="titulo destaque" style="padding-bottom:0px;">Produtos</div>
            <div class="listagem">
                <apex:variable var="subtotal" value="{!0}"/>
                
                <table cellpadding="0px" cellspacing="0px" border="0">
                    <apex:repeat value="{!produtos}" var="produto">
                        <tbody class='bloco'>

                            <!-- cabeçalho -->
                            <apex:outputText rendered="{!IF(produto.cabecalho,true,false)}">
                                <tr class="pre-cabecalho"><tr cellspacing="7"></tr></tr>
                                <tr class="cabecalho">
                                    <td style="visibility:hidden;border:0px;"></td>
                                    <td>Imagem</td>
                                    <td>Produto</td>
                                    <td>Modelo</td>
                                    <td>Fabricante</td>
                                    <td>Valor Unit.</td>
                                    <td>Qtd.</td>
                                    <td>Valor Total</td>
                                </tr>
                            </apex:outputText>
                            
                            <!-- item -->
                            <apex:variable var="tipo" value="{!IF(produto.item.Item_Pai__c==null,'equipamento','acessorio')}"/>
                            <tr class="item-dados {!tipo}">
                                <td rowspan="2"><apex:outputText value="{!produto.item.Item__c}" rendered="{!IF(tipo=='equipamento',true,false)}"/></td>
                                <td rowspan="2" class="imagem"><img src="{!produto.item.Product2.URL_da_Imagem__c}"/></td>
                                <td class="valor">
                                    COD: {!produto.item.Product2.StockKeepingUnit}
                                    <apex:outputText value="{!', LOTE: '+produto.item.Lote__c}" rendered="{!IF(produto.item.Lote__c!=null,true,false)}" />
                                    <br/>
                                    {!produto.item.Product2.Name}
                                </td>
                                <td class="valor">{!produto.item.Product2.Modelo__c}</td>
                                <td class="valor">{!produto.item.Product2.Marca__c}</td>
                                <td class="linha valor">
                                    <table cellpadding="0px" cellspacing="0px" border="0" style="width:100%; text-align:right!important;">
                                        <tr>
                                            <td class="linha valor" colspan="2" style="border-top:none;"><apex:outputField value="{!produto.item.UnitPrice}"/></td>
                                        </tr>
                                        <apex:outputText rendered="{!if(produto.item.Valor_Minimo__c!=null,true,false)}">
                                            <tr>
                                                <td class="linha valor" style="padding-right:0px;font-size:9px!important;">MIN</td>
                                                <td class="linha valor" style="font-size:9px!important;"><apex:outputField value="{!produto.item.Valor_Minimo__c}"/></td>
                                            </tr>
                                        </apex:outputText>
                                    </table>
                                </td>
                                <td class="linha valor"><apex:outputField value="{!produto.item.Quantity}"/></td>
                                <td class="linha valor"><apex:outputField value="{!produto.item.TotalPrice}"/></td>
                            </tr>
                            <tr class="item-descr">
                                <td colspan="6">{!produto.item.Descricao_da_linha__c}</td>
                            </tr>
                            
                            <!-- subtotal -->
                            <apex:variable var="subtotal" value="{!subtotal+produto.item.TotalPrice}"/>
                            <apex:outputText rendered="{!IF(produto.subtotal!=null,true,false)}">
                                <tr class="subtotal">
                                    <td colspan="2">&nbsp;</td>
                                    <td colspan="5" class="valor">SUBTOTAL</td>
                                    <td class="valor">{!produto.subtotal}</td>
                                </tr>
                                <apex:variable var="subtotal" value="{!0}"/>
                            </apex:outputText>
                        
                        </tbody>
                    </apex:repeat>
                </table>
            </div>
            <br/>
            <div class="obsimgs">Imagens ilustrativas.</div>
            <br/>
            
            <!-- Observações do operador -->
            <div class="bloco">
                <div class="titulo destaque">Observações do operador do processo</div>
                <table class="sessao" cellpadding="0px" cellspacing="0px" border="0">
                    <tr><td class="valor manuscrito" style="border-top:0px;"></td></tr>
                    <tr><td class="valor manuscrito"></td></tr>
                    <tr><td class="valor manuscrito"></td></tr>
                    <tr><td class="valor manuscrito"></td></tr>
                    <tr><td class="valor manuscrito"></td></tr>
                    <tr><td class="valor manuscrito"></td></tr>
                    <tr><td class="valor manuscrito"></td></tr>
                    <tr><td class="valor manuscrito"></td></tr>
                    <tr><td class="valor manuscrito"></td></tr>
                </table>
            </div>
            <br/>
            
            <!-- Declarações -->
            <div class="bloco">
                <div class="titulo">Declarações</div>
                <br/>
                <div class="paragrafo">Declaro que conferi e revisei todos os documento e itens, e os mesmos estão de acordo e atendem todo o processo licitatório.</div>
                <br/>
                <table class="assinatura">
                    <tr>
                        <td>
                            <br/><br/>____________________________________
                            <br/>Responsável pelo Processo 
                        </td>
                        <td>
                            <br/><br/>____________________________________
                            <br/>Operador do Processo
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <br/><br/>____________________________________
                            <br/>Nome:
                        </td>
                        <td>
                            <br/><br/>____________________________________
                            <br/>Nome:
                        </td>
                    </tr>
                </table>
                <br/>
            </div>
            
        </div>
        
    </body>
</apex:page>