<apex:page controller="Comiss" title="Comissão Por Vendedor" showHeader="false" sidebar="false" docType="HTML-5.0" standardStylesheets="false" >
    <body style="background-color:#f1f4f6" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script>
    	$(document).ready(function(){
        	
    	});
    </script>
        <link rel="stylesheet" href="https://cdn.metroui.org.ua/v4/css/metro-all.min.css"/>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
        <style type="text/css">               
            .font{
            font-family:"Arial";
            font-size:9.5pt;
            vertical-align:center;           
            }           
            .ct{
            text-align:center;
            font-size:10pt;
           	align:center;
            }
            .totais{
            text-align:center;
            font-size:10pt;
           	border:2px;
            background-color:#404040;
            color:white;
            }
            .ajuste{
            width:70%;
            float:left;
            }
            .vend{
            width:17% !important;
            font-size:10pt;
            height: 27px;
    		line-height: 27px;
			}
            .dep{
            width:17% !important;
            color:#404040 !important;
            background:white !important;
            font-size:10pt;
            height: 27px;
   		    line-height: 27px;
			}
            .fechar{
            width:215px !important;
			background-color:#404040;
			font-size:11px;
            color:white !important;
			}
            p{
            font-size:10pt;
            }
            .buscar{
            width:215px !important;
			background-color:#2c8500;
			font-size:11px;            
            }
            .limpar{
            width:192% !important;
            background-color: #850000;
            font-size:11px;
			}
            .ctnFlex{
  			display: flex;
			}
            div.op1 {
       	    width: 38%;
            font-size:12px;
            margin-right:0px;
   		    }
   			div.op2 {
            float:right !important;
            margin-right:40px;
   		    }
           .selectt{
            display: table;
            }            
            th,td {
            padding: 0px 6px;
            vertical-align:middle;
            }
            .pad{
            padding: 8px 8px;
            }
            .tit{
            padding:1px;
            }
            .table tbody td{
            padding: 0.5px;
            text-align:center;
            font-size:13px;
            }
            .table thead th{
            text-align:center;
			}
			.table tfoot th{
            color:white;
            text-align:center;
            padding:3px;
            }
            .metro-input{
            height:27px;
            }
        </style>
        <div class="ct"> 
            <div style="background-color:#e8ebed">        
		<table class="table table-border shadowed" style="text-align:center; width:100%">
            <tr><td style="font-size:24px;">COMISSÕES</td></tr>
            <tr><td>POR VENDEDOR</td></tr>
        </table>
                <apex:form ><apex:commandButton rendered="{!teste3}" styleClass="button secondary" style="float:left" value="Abrir filtros" action="{!show}"/></apex:form>
            </div><br/>
            </div>
        <div class="ctnFlex">
            <apex:form >
        <div class="op1">
            <apex:pageBlock rendered="{!teste}">                        
            <div><apex:commandButton styleClass="button secondary fechar shadowed" value="« Fechar" action="{!close}"/></div><br/>
			<apex:pageBlockSection >                
                <apex:inputText styleClass="metro-input" style="width:140px" value="{!colaborador}" label="Vendedor"/><br/><br/><br/>
                <apex:inputText styleClass="metro-input" style="width:140px"  value="{!gerente}" label="Gerente"/><br/><br/><br/>
                <apex:input styleClass="metro-input" style="width:140px"  type="date" value="{!startDate}" label="Período    Inicial"/><br/><br/><br/>
                <apex:input styleClass="metro-input" style="width:140px"  type="date" value="{!endDate}" label="Período    Final"/><br/><br/><br/>
                <apex:inputText styleClass="metro-input" style="width:140px"  value="{!Operacao}" label="Operação"/><br/><br/><br/>
            <apex:selectList styleClass="selectt icons metro-input" style="width:140px; height:68px" value="{!pago}" label="Situação">
                <apex:selectOption itemValue="true" itemLabel="Pagas"/>
                <apex:selectOption itemValue="false" itemLabel="Não Pagas"/>
                <apex:selectOption itemValue="todas" itemLabel="Todas"/>                
            </apex:selectList>
            </apex:pageBlockSection><br/>
				<apex:commandButton styleClass="button success buscar shadowed" value="→Procurar" action="{!search}" />&nbsp;
                <apex:commandButton id="botao" styleClass="button alert limpar shadowed" value="×Limpar" action="{!clear}"/>
            </apex:pageBlock> 
                </div>
            </apex:form><br/>
        <apex:variable value="{!0.00}" var="total1"/>
        <apex:variable value="{!0.00}" var="total2"/>
        <apex:variable value="{!0.00}" var="total3"/>
        <apex:form >
            <div class="op2">
                <apex:pageBlock rendered="{!teste2}">
            <p style="text-transform:upperCase; text-align:center; background-color:#404040; color:white">
            <b><apex:outputText value="Buscando por: " rendered="{!teste2}"/></b> 
            <apex:outputText rendered="{!IF(colaborador = null && gerente=null && startDate=null && endDate=null && operacao=null, true,false)}" value="Todos os Recebimentos"/>
            <apex:outputText rendered="{!IF(colaborador != null, true,false)}">Vendedor:<b> {!colaborador};</b></apex:outputText>&nbsp;
            <apex:outputText rendered="{!IF(gerente != null, true,false)}">Gerente:<b> {!gerente};</b></apex:outputText>&nbsp;
            <apex:outputText rendered="{!IF(operacao != null, true,false)}">Operação:<b> {!operacao};</b></apex:outputText>&nbsp;
            <apex:outputText rendered="{!IF(startDate != null, true,false)}">Data Inicial:<b><apex:outputText value=" {!startDate};"/></b></apex:outputText>&nbsp;
            <apex:outputText rendered="{!IF(endDate != null, true,false)}">Data final: <b><apex:outputText value="{!endDate};"/></b></apex:outputText>&nbsp;
            <apex:outputText rendered="{!IF(pago == 'true', true,false)}" value="Comissões já pagas"/>
            <apex:outputText rendered="{!IF(pago == 'false', true,false)}" value="Comissões não pagas"/>
            <apex:outputText rendered="{!IF(pago == 'todas', true,false)}" value="Comissões pagas e não pagas"/>
            </p>            
                <apex:pageBlockTable styleClass="table table-border striped tablea" align="center" var="Registros" value="{!Records}" headerClass="ct" footerClass="totais">
                <apex:column headerValue="Pedido">
                    <apex:outputField value="{!Registros.Titulo__r.Faturamento__r.Pedido__c}"/>
                    <apex:facet name="footer">TOTAL</apex:facet>
                </apex:column>
                <apex:column headerValue="Faturamento">
                    <apex:outputField value="{!Registros.Titulo__r.Faturamento__c}"/>
                </apex:column>
                <apex:column headerValue="Título">
                    <apex:outputField value="{!Registros.Titulo__c}"/>
                </apex:column>
                <apex:column style="vertical-align:center; text-align:center" headerValue="Recebimento">
                    <apex:outputLink title="Abrir detalhes do recebimento" value="https://hospcom--developer.my.salesforce.com/{!Registros.Id}">{!Registros.Name}</apex:outputLink>
                </apex:column>
                <apex:column headerValue="Operação">
                        <apex:outputField value="{!Registros.Titulo__r.Faturamento__r.Pedido__r.Natureza_de_Opera_o__c}"/>
                </apex:column>
                <apex:column headerValue="Vendedor">
                    <apex:outputText value="{!Registros.Vendedor__c}"/>
                </apex:column>
                <apex:column headerValue="Gerente">
                    <apex:outputText value="{!Registros.Gerente__c}"/>
                </apex:column>
                <apex:column headerValue="Valor Recebido">
                    <apex:outputField value="{!Registros.Valor_Recebido__c}"/>
                    <apex:variable var="total2" value="{!total2 + Registros.Valor_Recebido__c}" />
                   	<apex:facet name="footer"> BRL <span class="t2"></span></apex:facet>
                </apex:column>
				<apex:column headerValue="Data do Recebimento">
					<apex:outputField value="{!Registros.Data_do_Recebimento__c}"/>
				</apex:column>
                <apex:column headerValue="Comissão do Vendedor" title="R$ {!Registros.ComissaoVendedor__c}">
                    <apex:outputField value="{!Registros.ComissaoVendedor__c}"/>                   
					<apex:variable var="total1" value="{!total1 + Registros.ComissaoVendedor__c}" />
                   	<apex:facet name="footer"> BRL <span class="t1"></span></apex:facet>
                </apex:column> 
                <apex:column headerValue="Paga">
                    <apex:outputField styleClass="selectt" value="{!Registros.ComissaoPaga__c}"/>
                </apex:column>
                <apex:column headerValue="Comissão do Gerente" title="R$ {!Registros.ComissaoGerente__c}" footerClass="t2">
                    <apex:outputField value="{!Registros.ComissaoGerente__c}"/>
					<apex:variable var="total3" value="{!total3 + Registros.ComissaoGerente__c}" />
                    <apex:facet name="footer"> BRL <span class="t3"></span></apex:facet>
                </apex:column>
				<apex:column headerValue="Paga">
                    <apex:outputField styleClass="selectt" value="{!Registros.Comissao_Gerente_Paga__c}"/>
                </apex:column>                    
                <apex:inlineEditSupport event="onClick" 
                        showOnEdit="saveButton,cancelButton"/> 
                </apex:pageBlockTable>
                <apex:pageBlockButtons >
                <apex:commandButton value="Salvar" styleClass="button bg-cyan bg-lightGreen-hover bg-darkRed-active fg-white" action="{!save}" id="saveButton" style="display: none;"/>
            	<apex:commandButton styleClass="button bg-red bg-Red-hover bg-darkRed-active fg-white" style="display: none;" value="Cancelar" onclick="resetInlineEdit()" action="{!cancel}" id="cancelButton"/>
                </apex:pageBlockButtons>
                </apex:pageBlock>
            </div>
            </apex:form>
        </div>            
            <apex:form >
            <apex:pageBlock rendered="{!mostrarprem}">
                <apex:commandButton styleClass="fechar" value="Fechar" action="{!pageclose}" rendered="{!mostrarprem}" />
				<apex:iframe frameborder="false" scrolling="true" src="https://hospcom--developer--c.visualforce.com/apex/Premiacoes?core.apexpages.request.devconsole=1" />
            </apex:pageBlock>
            </apex:form>
        <script>
        var x = '{!total1}';
        var y = '{!total2}';
        var z = '{!total3}';        
            document.getElementsByClassName('t1')[0].innerHTML = x.replace(".", ",").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.");
            document.getElementsByClassName('t2')[0].innerHTML = y.replace(".", ",").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.");
            document.getElementsByClassName('t3')[0].innerHTML = z.replace(".", ",").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.");
		
        </script>
        </body>
</apex:page>